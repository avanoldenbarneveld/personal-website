---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from 'astro:content';

const posts = await getCollection('blog', ({ data }) => !data.draft);
posts.sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime());
---

<Layout title="Blog">
  <main>
    <h1>Blog</h1>

    <div class="blog-intro">
      <p>
        This blog is where I share the way I think through the things I care about.
        I like to dive deep, follow the details, and build a clear structure around them.
        Writing here brings clarity to that process.
      </p>
    </div>

    {posts.length === 0 ? (
      <p>No posts yet. Check back soon!</p>
    ) : (
      <div class="post-list">
        {posts.map((post) => (
          <article class="post-item">
            <h2 class="post-title">
              <a href={`/blog/${post.slug}`}>{post.data.title}</a>
            </h2>
            <p class="post-description">{post.data.description}</p>
            <p class="post-date">
              {post.data.pubDate.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
              })}
            </p>
          </article>
        ))}
      </div>
    )}
  </main>
</Layout>
